@page
@model Asignment_PRN231_API_FE.Pages.Authentication.GoogleLoginModel
@{
    ViewData["Title"] = "Google Login";
    Layout = "/Pages/Shared/_LayoutAuthentication.cshtml";
}

<script src="https://accounts.google.com/gsi/client" async defer></script>
<div id="layoutAuthentication">
    <div id="layoutAuthentication_content">
        <main>
            <div class="container-xl px-4">
                <div class="row justify-content-center">
                    <div class="col-xl-5 col-lg-6 col-md-8 col-sm-11">
                        <!-- Social login form-->
                        <div class="card my-5">
                            <div class="card-body p-5 text-center">
                                <div class="h3 fw-light mb-3">Sign In</div>

                                <a class="btn btn-icon btn-google mx-1" href="#"><i class="fab fa-google fa-fw fa-sm"></i></a>

                            </div>
                            <hr class="my-0" />
                            <div class="card-body p-5 d-flex justify-content-center align-items-center">
                                <!-- Login form-->
                                <form method="post" onsubmit="return false;" class="text-center">
                                    <input type="hidden" asp-for="IdToken" id="idTokenField" />

                                    <div id="g_id_onload"
                                         data-client_id="55309494598-jikjdhqoumeciar5mb9cu9hdg5maradb.apps.googleusercontent.com"
                                         data-context="signin"
                                         data-ux_mode="popup"
                                         data-callback="handleCredentialResponse"
                                         data-auto_prompt="false">
                                    </div>

                                    <div class="g_id_signin" data-type="standard"></div>

                                    <script>
                                        function handleCredentialResponse(response) {
                                            console.log("Google ID Token:", response.credential); // Debug ID Token
                                            document.getElementById("idTokenField").value = response.credential;
                                            document.forms[0].submit();
                                        }
                                    </script>
                                </form>

                            </div>
                            <hr class="my-0" />
                            <div class="card-body px-5 py-4">
                                <div class="small text-center">
                                    New user?
                                    <a href="/Authentication/Register">Create an account!</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <partial name="_Layout_Footer_Authentication" />
</div>
